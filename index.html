<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MD AI Hub - Use Cases</title>
    <style>
        :root {
            --primary-blue: #0071e3;
            --primary-hover: #0077ED;
            --bg-body: #ffffff;
            --bg-hero: linear-gradient(135deg, #e3f2fd 0%, #f0f4f8 100%);
            --text-main: #1d1d1f;
            --text-secondary: #86868b;
            --card-border: #f5f5f7;
            --card-shadow: 0 4px 20px rgba(0,0,0,0.04);
            --pill-bg: #e1f0ff;
            --pill-text: #0071e3;
            
            /* Status Colors (Refined for Hub Look) */
            --cat-1a-bg: #dcfce7; --cat-1a-text: #166534; /* Green */
            --cat-1b-bg: #ecfccb; --cat-1b-text: #4d7c0f; /* Lime */
            --cat-2-bg: #fef9c3; --cat-2-text: #854d0e; /* Yellow */
            --cat-3-bg: #fee2e2; --cat-3-text: #991b1b; /* Red */
        }

        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Helvetica, Arial, sans-serif; }

        body {
            margin: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 3rem;
            background: white;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-left { display: flex; align-items: center; gap: 12px; font-weight: 600; font-size: 1.1rem; color: var(--primary-blue); }
        .nav-logo-icon { font-size: 1.4rem; }
        
        .nav-links { display: flex; gap: 2rem; align-items: center; font-size: 0.9rem; color: var(--text-secondary); font-weight: 500; }
        .nav-link { text-decoration: none; color: inherit; transition: color 0.2s; cursor: pointer; }
        .nav-link:hover { color: var(--text-main); }
        .nav-link.active { color: var(--text-main); font-weight: 600; }

        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .btn-primary:hover { opacity: 0.9; }

        /* Hero Section */
        .hero {
            background: var(--bg-hero);
            margin: 2rem 3rem;
            padding: 4rem 2rem;
            border-radius: 24px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .hero-icon { font-size: 3rem; margin-bottom: 0.5rem; }
        .hero-title { font-size: 2.5rem; font-weight: 700; margin: 0; color: #1d1d1f; }
        .hero-subtitle { font-size: 1.1rem; color: var(--text-secondary); max-width: 600px; line-height: 1.5; }

        /* Action Bar */
        .action-bar {
            margin: 0 3rem 2rem 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filters { display: flex; gap: 1rem; }
        
        .select-filter {
            padding: 0.6rem 1rem;
            border-radius: 12px;
            border: 1px solid #d2d2d7;
            background: white;
            color: var(--text-main);
            font-size: 0.9rem;
            outline: none;
            cursor: pointer;
        }

        /* Stats Strip */
        .stats-strip {
            display: flex;
            gap: 2rem;
            margin: 0 3rem 2rem 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #f0f0f0;
            overflow-x: auto;
        }
        
        .stat-item { display: flex; flex-direction: column; gap: 4px; }
        .stat-num { font-size: 1.2rem; font-weight: 700; color: var(--text-main); }
        .stat-desc { font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }

        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            padding: 0 3rem 4rem 3rem;
        }

        .hub-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--card-border);
            box-shadow: var(--card-shadow);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            flex-direction: column;
            height: 100%;
            cursor: pointer;
            position: relative;
        }

        .hub-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.08);
        }

        .card-icon { font-size: 2rem; margin-bottom: 1rem; }
        
        .card-title { font-size: 1.25rem; font-weight: 600; margin: 0 0 0.5rem 0; color: var(--text-main); }
        
        .card-desc { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.5; margin-bottom: 1.5rem; flex-grow: 1; }

        .card-meta { display: flex; justify-content: space-between; align-items: center; margin-top: auto; }
        
        .pill {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }

        /* Read-only Modal styling */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .modal-overlay.open { display: flex; opacity: 1; }

        .modal {
            background: white;
            width: 100%;
            max-width: 600px;
            border-radius: 24px;
            padding: 3rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 1px solid #f0f0f0;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-btn { 
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: none; 
            border: none; 
            font-size: 1.5rem; 
            color: var(--text-secondary); 
            cursor: pointer;
            padding: 0.5rem;
        }

        .detail-row {
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #f5f5f7;
            padding-bottom: 1rem;
        }
        .detail-row:last-child { border-bottom: none; }
        
        .detail-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .detail-value {
            font-size: 1.1rem;
            color: var(--text-main);
            line-height: 1.4;
        }

    </style>
</head>
<body>

    <nav>
        <div class="nav-left">
            <span class="nav-logo-icon">üöÄ</span>
            MD AI Hub
        </div>
        <div class="nav-links">
            <a class="nav-link">Home</a>
            <a class="nav-link">AI Journey</a>
            <a class="nav-link">Resources</a>
            <a class="nav-link">Leaderboard</a>
            <a class="nav-link">Projects</a>
            <a class="nav-link active">Use Cases</a>
        </div>
        <div style="width: 100px;"></div> <!-- Spacer to balance layout -->
    </nav>

    <div class="hero">
        <div class="hero-icon">üß©</div>
        <h1 class="hero-title">Use Case Tracker</h1>
        <div class="hero-subtitle">
            Explore how different functions are leveraging AI to solve problems, increase efficiency, and drive innovation across the organization.
        </div>
    </div>

    <!-- Stats -->
    <div class="stats-strip">
        <div class="stat-item">
            <span class="stat-num" id="stat-total">0</span>
            <span class="stat-desc">Total Use Cases</span>
        </div>
        <div class="stat-item">
            <span class="stat-num" id="stat-active" style="color: #166534">0</span>
            <span class="stat-desc">Leveraging AI</span>
        </div>
        <div class="stat-item">
            <span class="stat-num" id="stat-hours">0</span>
            <span class="stat-desc">Est. Hours Saved</span>
        </div>
    </div>

    <div class="action-bar">
        <div class="filters">
            <select class="select-filter" id="filter-function" onchange="applyFilters()">
                <option value="All">All Functions</option>
                <!-- Populated dynamically if needed, or kept static -->
                <option value="MDPM/OPM">MDPM/OPM</option>
                <option value="Function A">Function A</option>
                <option value="Function B">Function B</option>
            </select>
            <select class="select-filter" id="filter-category" onchange="applyFilters()">
                <option value="All">All Categories</option>
                <option value="1a">Leveraging AI</option>
                <option value="1b">In Development</option>
                <option value="2">Not Leveraging</option>
                <option value="3">Under ID</option>
            </select>
        </div>
    </div>

    <div id="grid-container" class="grid">
        <!-- Cards injected here -->
        <div style="grid-column: 1/-1; text-align: center; color: #86868b; padding: 2rem;">
            Loading use cases from CSV...
        </div>
    </div>

    <!-- Read Only Modal -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal" id="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div id="modal-body">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <script>
        let useCases = [];

        // 1. Fetch CSV Data
        async function fetchCSV() {
            try {
                // IMPORTANT: Ensure 'use_cases.csv' exists in the same folder
                const response = await fetch('use_cases.csv');
                
                if (!response.ok) {
                    throw new Error('Failed to load CSV file');
                }
                
                const text = await response.text();
                useCases = parseCSV(text);
                
                // Refresh UI
                init();
            } catch (error) {
                console.error(error);
                document.getElementById('grid-container').innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; color: #ff3b30; padding: 2rem;">
                        <h3>Error Loading Data</h3>
                        <p>Could not load 'use_cases.csv'. Please check if the file exists.</p>
                        <p style="font-size:0.8rem; margin-top:1rem;">(Using demo data for now...)</p>
                    </div>
                `;
                // Fallback to demo data so page isn't broken
                useCases = getDemoData();
                setTimeout(init, 1500);
            }
        }

        // 2. Parse CSV Text
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            if (lines.length < 2) return [];

            // Assumes header row: Function,Use Case,Category,Activity Type,Time Spent,Tool,Is AI
            // We map these by index for simplicity. 
            // Better: parse header row to find indices.
            
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                // Simple CSV split (handling quotes is complex, simple split for now)
                // If you use commas inside fields, you need a robust CSV parser
                const row = lines[i].split(',').map(c => c.trim());
                if (row.length < 5) continue;

                // Map row to object based on expected column order from Numbers export
                // Adjust indices based on your actual CSV column order
                data.push({
                    id: i,
                    function: row[0] || 'Unknown',
                    name: row[1] || 'Untitled',
                    category: cleanCategory(row[2]),
                    activity: row[3] || '',
                    time: row[4] || '',
                    tool: row[6] || row[5] || 'N/A', // Flexible mapping
                    isAi: (row[7] || row[6] || '').toLowerCase().includes('yes') ? 'Yes' : 'No'
                });
            }
            return data;
        }

        function cleanCategory(cat) {
            // Normalize "CAT 1a" -> "1a", "Category 2" -> "2"
            if (!cat) return '3';
            return cat.replace(/cat\s*|category\s*/gi, '').trim();
        }

        function getDemoData() {
            return [
                { id: 1, function: "MDPM/OPM", name: "Yield Analysis", category: "1a", activity: "Problem Solving", time: "2-4", tool: "Custom AI", isAi: "Yes" },
                { id: 2, function: "MDPM/OPM", name: "Data Entry", category: "2", activity: "Repetitive", time: ">4", tool: "Excel", isAi: "No" }
            ];
        }

                // Map row to object based on expected column order
                // indices: 0=Func, 1=Name, 2=Cat, 3=Activity, 4=Time, 5=NewToolNeeded?, 6=ExistingTool, 7=IsAI, 8=DevTool
                data.push({
                    id: i,
                    function: row[0] || 'Unknown',
                    name: row[1] || 'Untitled',
                    category: cleanCategory(row[2]),
                    activity: row[3] || '',
                    time: row[4] || '',
                    existingTool: row[6] || 'N/A', 
                    isAi: (row[7] || '').trim(),
                    devTool: row[8] || 'N/A'
                });
            }
            return data;
        }

        function cleanCategory(cat) {
            if (!cat) return '3';
            return cat.replace(/cat\s*|category\s*/gi, '').trim();
        }

        function getDemoData() {
            return [
                { id: 1, function: "MDPM/OPM", name: "Yield Analysis", category: "1a", activity: "Problem Solving", time: "2-4", existingTool: "Custom AI", isAi: "Yes", devTool: "N/A" },
                { id: 2, function: "MDPM/OPM", name: "Data Entry", category: "2", activity: "Repetitive", time: ">4", existingTool: "Excel", isAi: "No", devTool: "Studio" }
            ];
        }

        function init() {
            applyFilters();
            updateStats();
        }
        
        // ... (Helper functions remain same) ...

        function getCardIcon(activity) {
            if (activity.includes("Repetitive")) return "‚öôÔ∏è";
            if (activity.includes("Problem")) return "üß†";
            if (activity.includes("Domain")) return "üìö";
            return "üìã";
        }
        
        // ... (Styles and rendering) ...
        
        function renderGrid(data) {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';

            if (data.length === 0) {
                container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:2rem; color:#888;">No use cases found.</div>';
                return;
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'hub-card';
                card.onclick = () => viewUseCase(item.id);

                const icon = getCardIcon(item.activity);
                const pillStyle = getCategoryStyle(item.category);
                const pillLabel = getCategoryLabel(item.category);
                
                // Card preview shows existing tool or dev tool
                const displayTool = (item.existingTool && item.existingTool !== 'N/A' && item.existingTool !== 'Na') 
                    ? item.existingTool 
                    : (item.devTool !== 'N/A' && item.devTool !== 'Na' ? item.devTool + ' (Dev)' : 'None');

                card.innerHTML = `
                    <div class="card-icon">${icon}</div>
                    <h3 class="card-title">${item.name}</h3>
                    <div class="card-desc">
                        <div style="font-weight: 500; color: var(--text-main); margin-bottom: 4px;">${item.function}</div>
                        ${item.activity}
                        <div style="margin-top: 6px; font-size: 0.85rem; color: var(--text-secondary);">
                            Tool: ${displayTool}
                        </div>
                    </div>
                    <div class="card-meta">
                        <span class="pill" style="${pillStyle}">${pillLabel}</span>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        function applyFilters() {
            const funcFilter = document.getElementById('filter-function').value;
            const catFilter = document.getElementById('filter-category').value;

            const filtered = useCases.filter(item => {
                const matchFunc = funcFilter === 'All' || item.function === funcFilter;
                // Flexible category matching
                const matchCat = catFilter === 'All' || item.category.includes(catFilter) || (catFilter === '3' && !['1a','1b','2'].some(x=>item.category.includes(x)));
                return matchFunc && matchCat;
            });

            renderGrid(filtered);
            updateStats(filtered); // Pass filtered data to stats
        }

        function updateStats(filteredData) {
            // Use filtered data if provided, otherwise default to all useCases
            const dataToCount = filteredData || useCases;

            document.getElementById('stat-total').innerText = dataToCount.length;
            document.getElementById('stat-active').innerText = dataToCount.filter(u => u.category.includes('1a')).length;
            
            // Simple hour estimation
            const totalHours = dataToCount.reduce((acc, curr) => {
                let h = 0;
                if (curr.time.includes('0-0.5')) h = 0.25;
                else if (curr.time.includes('0.5-2')) h = 1.25;
                else if (curr.time.includes('2-4')) h = 3;
                else if (curr.time.includes('>4')) h = 5;
                return acc + h;
            }, 0);
            document.getElementById('stat-hours').innerText = Math.round(totalHours);
        }
                    <span class="pill" style="${pillStyle}; font-size: 0.9rem; padding: 6px 14px;">${pillLabel}</span>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="detail-row">
                        <div class="detail-label">Activity Type</div>
                        <div class="detail-value">${item.activity}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Time Spent</div>
                        <div class="detail-value">${item.time}</div>
                    </div>
                </div>

                <div class="detail-row">
                    <div class="detail-label">Current Tool</div>
                    <div class="detail-value" style="display: flex; align-items: center; gap: 8px;">
                        ${hasExisting ? item.existingTool : 'None'}
                        ${isAi ? '<span style="font-size: 0.75rem; background: #e3f2fd; color: #0071e3; padding: 2px 8px; border-radius: 4px; font-weight:600;">AI Powered</span>' : ''}
                    </div>
                </div>
                
                ${hasDev ? `
                <div class="detail-row">
                    <div class="detail-label">Tool In Development</div>
                    <div class="detail-value" style="color: #d97706;">
                        Build: ${item.devTool}
                    </div>
                </div>` : ''}
            `;
            
            modalOverlay.classList.add('open');
        }
            `;
            
            modalOverlay.classList.add('open');
        }

        function closeModal() {
            modalOverlay.classList.remove('open');
        }

        // Start Fetching
        fetchCSV();

        // Close on click outside
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) closeModal();
        });

    </script>
</body>
</html>
